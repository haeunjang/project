<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
  <link rel="stylesheet" href="./css/edit.css">
  <!--제목-->
  <title>T.P.O</title>
  <!--글씨체 적용-->
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+KR&display=swap');
  </style>

  <!--파비콘-->
  <!--<link rel="shortcut icon" href="favicon.ico" />-->
  <link rel="icon" href="/public/image/fabicon.ico" />
  <!--브라우저 스타일 초기화-->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reset-css@5.0.1/reset.min.css" />  
  <!--Google Material Icons-->
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" />
  <link rel="stylesheet" href="./css/edit.css" />

  <!--GSAP & ScrollToPlugin-->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.5.1/gsap.min.js" integrity="sha512-IQLehpLoVS4fNzl7IfH8Iowfm5+RiMGtHykgZJl9AWMgqx0AmJ6cRWcB+GaGVtIsnC4voMfm8f2vwtY+6oPjpQ==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.5.1/ScrollToPlugin.min.js" integrity="sha512-nTHzMQK7lwWt8nL4KF6DhwLHluv6dVq/hNnj2PBN0xMl2KaMm1PM02csx57mmToPAodHmPsipoERRNn4pG7f+Q==" crossorigin="anonymous"></script>
  <!--Swiper-->
  <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />
  <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
  <!--ScrollMagic-->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.8/ScrollMagic.min.js"></script>
  <!--Lodash-->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.20/lodash.min.js" integrity="sha512-90vH1Z83AJY9DmlWa8WkjkV79yfS2n2Oxhsi2dZbIv0nC4E6m5AbH8Nh156kkM7JePmqD6tcZsfad1ueoaovww==" crossorigin="anonymous"></script>

</head>

<body>
    <!--HEADER-->
  <header>
    <h1>T. P. O. </h1>
    <div class="inner">
      <div class="sub-menu">
        <ul class="menu">
          <li>
            <a href="index.html">Home</a>
          </li>
          <li>
            <a href="login.html">login</a>
          </li>
          <li>
            <a href="javascript:void(0)">My Page</a>
          </li>
          <li>
            <a href="upload.html">관리자</a>
          </li>    
        </ul>
        <div class="search">
          <input type="text" />
          <span class="material-icons">search</span>
        </div>
      </div>
    </div>
  </header>

<section class="visual">
  <div class="inner">

    <div class="upload_box">
        <p class="box-title">Edit Clothes</p>
        <div class="text_container">
          <li class="classify">
          <p class="title">성별</p>
          <label><input type="radio" id="female" name = "gender" placeholder="gender" value="여자"> 여자</input></label>
          <label><input type ="radio" id="male" name = "gender" placeholder="gender" value="남자"> 남자</input></label>
          </li>
          <li class="classify">
          <p class="title">옷</p>
          <select id="main_list" name="main_list" onchange="categoryChange(this)">
          <option>===옷 종류===</option>
          <option value="상의">상의</option>
          <option value="하의">하의</option>
          <option value="아우터">아우터</option>
          <option value="원피스">원피스</option>
          </select>
          
          <select id="good" name = "sub_list">
          <option>===세부 정보===</option>
          </select>
          <script>
          function categoryChange(e) {
              var good_상의 = ["반팔티", "긴팔티", "니트조끼", "반팔니트", "긴팔니트", "반팔셔츠", "긴팔셔츠", "원피스", "후드티"];
              var good_하의 = ["청바지","반바지","면바지","치마","트레이닝","슬랙스"];
              var good_아우터 = ["자켓", "가디건", "코트", "패딩"];
              var good_원피스 = ["원피스"];
              var target = document.getElementById("good");
          
              if(e.value == "상의") var d = good_상의;
              else if(e.value == "하의") var d = good_하의;
              else if(e.value == "아우터") var d = good_아우터;
              else if(e.value == "원피스") var d = good_원피스;
          
              target.options.length = 0;
          
              for (x in d) {
              var opt = document.createElement("option");
              opt.value = d[x];
              opt.innerHTML = d[x];
              target.appendChild(opt);
              } 
          }
          </script>
          <p class="rule">옷 종류와 세부정보를 재설정하십시오</p>
          </li>
    
        </div>
        
        <div class="image_container" id="image_container">
          <div class="image" id="image">
      
          </div>
          <p class="rule" style="float:right; margin-right:200px;">이미지는 재설정이 불가합니다.</p>
      </div>
      <button class="btn btn-dark mt-3" id="send" style="background-color:rgb(255, 182, 182); margin:auto;">edit</button>
      
    </div>


      <script src="https://www.gstatic.com/firebasejs/8.6.5/firebase-app.js"></script>
      <script src="https://www.gstatic.com/firebasejs/8.6.5/firebase-auth.js"></script>
      <script src="https://www.gstatic.com/firebasejs/8.6.5/firebase-firestore.js"></script>
      <script src="https://www.gstatic.com/firebasejs/8.6.5/firebase-storage.js"></script>
      
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4" crossorigin="anonymous"></script>
      <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> 

      <script>
        var firebaseConfig = {
            apiKey: "AIzaSyBVaapmep0_PuQw1e2gZHXZdRe2AqXhmg4",
            authDomain: "tpo2-7b5d0.firebaseapp.com",
            projectId: "tpo2-7b5d0",
            storageBucket: "tpo2-7b5d0.appspot.com",
            messagingSenderId: "197250258766",
            appId: "1:197250258766:web:c9e6260e6a04e30bb9b01f"
            };
            firebase.initializeApp(firebaseConfig);
        </script>


      <script>
          const db = firebase.firestore();
          const storage = firebase.storage();

          var 쿼리스트링 = new URLSearchParams(window.location.search);

          db.collection('product').doc(쿼리스트링.get('id')).get().then((result)=>{

            if(result.data().성별=="여자") {
              $("#female").prop("checked",true);
            }
            else{
              $("#male").prop("checked",true);
            }
            

            var img = document.createElement("img");
 
            img.src = result.data().이미지;
            var src = document.getElementById("image");
            
            src.appendChild(img);
          

          })

          $('#send').click(function(){
          var 바꿀거 = {
            성별 : $('input[name="gender"]:checked').val(),
            옷분류 : $('select[name=main_list]').val(),
            옷종류 : $('select[name=sub_list]').val()
          }
          db.collection('product').doc(쿼리스트링.get('id')).update(바꿀거)
          window.location.href = './view.html';
          alert("수정이 완료되었습니다. ");
        })

    </script>
   
  </div>
  
    

</section>
</body>
</html>